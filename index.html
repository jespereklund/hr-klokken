<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./seven-segment" rel="stylesheet">
    <title>Hr Klokken</title>
</head>
<body>
    <script>
        /*
        const talTimes = {
            "og0"  : 0,
            "og10" : 1.688,
            "og20" : 3.138,
            "og30" : 4.833,
            "og40" : 6.511,
            "og50" : 8.083,
            "0"    : 9.872,
            "1"    : 11.200,
            "2"    : 12.550,
            "3"    : 13.949,
            "4"    : 15.464,
            "5"    : 17.088,
            "6"    : 18.370,
            "7"    : 19.879,
            "8"    : 21.299,
            "9"    : 22.736,
            "10"   : 24.077,
            "11"   : 25.486,
            "12"   : 26.945,
            "13"   : 28.290,
            "14"   : 29.719,
            "15"   : 31.190,
            "16"   : 32.706,
            "17"   : 34.204,
            "18"   : 35.641,
            "19"   : 36.963,
            "20"   : 38.374,
            "21"   : 39.863,
            "22"   : 41.706,
            "23"   : 43.584,
            "24"   : 45.550,
            "25"   : 47.483,
            "26"   : 49.383,
            "27"   : 51.265,
            "28"   : 53.163,
            "29"   : 55.031,
            "30"   : 56.916,
            "31"   : 58.446,
            "32"   : 60.296,
            "33"   : 62.183,
            "34"   : 64.196,
            "35"   : 66.203,
            "36"   : 68.090,
            "37"   : 69.962,
            "38"   : 71.869,
            "39"   : 73.755,
            "40"   : 75.773,
            "41"   : 77.184,
            "42"   : 78.982,
            "43"   : 80.815,
            "44"   : 82.726,
            "45"   : 84.660,
            "46"   : 86.510,
            "47"   : 88.300,
            "48"   : 90.178,
            "49"   : 92.026,
            "50"   : 93.876,
            "51"   : 95.439,
            "52"   : 97.278,
            "53"   : 99.230,
            "54"   : 101.279,
            "55"   : 103.329,
            "56"   : 105.239,
            "57"   : 107.190,
            "58"   : 109.138,
            "59"   : 111.074,
            "duut" : 112.823
        }
        */

        const talTimes = {
            "og0"  : 1.155,
            "og10" : 2.735,
            "og20" : 4.430,
            "og30" : 6.249,
            "og40" : 8.008,
            "og50" : 9.741,
            "0"    : 11.882,
            "1"    : 13.516,
            "2"    : 15.093,
            "3"    : 16.724,
            "4"    : 18.608,
            "5"    : 20.321,
            "6"    : 21.810,
            "7"    : 23.319,
            "8"    : 25.054,
            "9"    : 26.809,
            "10"   : 28.636,
            "11"   : 30.363,
            "12"   : 32.254,
            "13"   : 34.017,
            "14"   : 35.759,
            "15"   : 37.510,
            "16"   : 39.373,
            "17"   : 41.157,
            "18"   : 43.079,
            "19"   : 44.756,
            "20"   : 46.472,
            "21"   : 48.388,
            "22"   : 50.216,
            "23"   : 52.031,
            "24"   : 53.922,
            "25"   : 55.940,
            "26"   : 57.599,
            "27"   : 59.511,
            "28"   : 61.393,
            "29"   : 63.073,
            "30"   : 64.887,
            "31"   : 66.725,
            "32"   : 68.666,
            "33"   : 70.591,
            "34"   : 72.647,
            "35"   : 74.748,
            "36"   : 76.640,
            "37"   : 78.775,
            "38"   : 80.867,
            "39"   : 82.851,
            "40"   : 84.869,
            "41"   : 86.704,
            "42"   : 88.546,
            "43"   : 90.525,
            "44"   : 92.543,
            "45"   : 94.553,
            "46"   : 96.299,
            "47"   : 98.272,
            "48"   : 100.371,
            "49"   : 102.168,
            "50"   : 103.961,
            "51"   : 106.044,
            "52"   : 108.122,
            "53"   : 110.328,
            "54"   : 112.569,
            "55"   : 114.829,
            "56"   : 117.057,
            "57"   : 119.164,
            "58"   : 121.383,
            "59"   : 123.526,
			"00"   : 125.996,
			"01"   : 127.965,
			"02"   : 130.083,
			"03"   : 132.124,
			"04"   : 134.048,
			"05"   : 136.013,
			"06"   : 137.997,
			"07"   : 139.919,
			"08"   : 141.661,
			"09"   : 143.537,
            "duut" : 145.438        
        }

        let tal = new Audio("tal2.mp3")

        tal.addEventListener("loadeddata", (event) => {
            document.getElementById("startBtn").style.visibility = "visible"
        })

        let clock = new Date()
        let oldSecond = 0

        function startTimer() {
            setInterval(() => {
                let date = new Date()
                if (date.getSeconds() != oldSecond) {

                    //say digit
                    sayDigit(date)
                    oldSecond = date.getSeconds()

                    //clock display
                    clock = new Date()
                    document.getElementById("clock").innerHTML = clock.toTimeString().split(' ')[0]
                }
            }, 50)
        }

        function sayDigit(date) {
            switch(date.getSeconds()) {

                // duut
                case 0: case 10: case 20: case 30: case 40: case 50:
                    say("duut")
                    break

                // Hours
                case 4: case 14: case 24: case 34: case 44: case 54:
                    if(date.getMinutes() === 59 && date.getSeconds() === 54) {
                        say((date.getHours() + 1) % 24)
                    } else {
                        say(date.getHours())
                    }
                    break

                // Minutes
                case 6: case 16: case 26: case 36: case 46:
                    if(date.getMinutes() < 10) {
                        say("0" + date.getMinutes())
                    } else {
                        say(date.getMinutes())
                    }
                    
                    break

                case 56:
                    say((date.getMinutes() + 1) % 60)
                    break

                // Seconds
                case 8: case 18: case 28: case 38: case 48:
                    say("og" + Number(date.getSeconds() + 2))
                    break

                case 58:
                    say("og0")
                    break
            }
        }

        function say(sample) {
            tal.currentTime = talTimes[sample] 
            tal.play()
            setTimeout(
                stopAudio,
                1500
            )
        }

        function stopAudio() {
            tal.pause();
            tal.currentTime = 0;
        }

        function start() {
            document.getElementById("content").style.visibility = "visible"
            document.getElementById("startBtn").style.visibility = "hidden"
            startTimer()
        }
            
    </script>
    <button id="startBtn" style="visibility: hidden;" onclick="start()">Start Hr Klokken</button>
    <div id="content" style="visibility: hidden; background-color: black; width: 230px; height: 80px;">
        <p id="clock" style="font-size: 60px; font-family: 'Seven Segment'; color: crimson; font-style: italic; padding: 10px;"></p>
    </div>        
</body>
</html>